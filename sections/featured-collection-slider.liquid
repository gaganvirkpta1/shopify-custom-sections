{% schema %}
{
  "name": "Featured Collection Slider",
  "tag": "section",
  "class": "featured-collection-slider",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Select Collection"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Featured Products"
    },
    {
      "type": "checkbox",
      "id": "enable_autoplay",
      "label": "Enable Autoplay",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Featured Collection Slider"
    }
  ]
}
{% endschema %}

<div class="collection-slider-section">
  {% if section.settings.heading != blank %}
    <h2 class="text-center text-3xl font-bold mb-6">{{ section.settings.heading }}</h2>
  {% endif %}

  <div class="slider-container">
    <div class="product-slider" data-autoplay="{{ section.settings.enable_autoplay }}">
      {% for product in collections[section.settings.collection].products %}
        <div class="product-card">
          <a href="{{ product.url }}">
            <img src="{{ product.featured_image | image_url: width: 400 }}" alt="{{ product.title }}" />
            <h3>{{ product.title }}</h3>
            <p>{{ product.price | money }}</p>
          </a>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  .collection-slider-section {
    padding: 40px 20px;
    background: #f9f9f9;
  }
  .product-slider {
    display: flex;
    overflow-x: auto;
    gap: 20px;
    scroll-snap-type: x mandatory;
  }
  .product-card {
    min-width: 200px;
    scroll-snap-align: start;
    background: white;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 15px;
    text-align: center;
  }
  .product-card img {
    max-width: 100%;
    border-radius: 6px;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const slider = document.querySelector('.product-slider');
    const autoplay = slider?.dataset?.autoplay === 'true';

    if (autoplay) {
      let scrollAmount = 0;
      setInterval(() => {
        if (slider.scrollLeft + slider.clientWidth >= slider.scrollWidth) {
          slider.scrollLeft = 0;
        } else {
          slider.scrollLeft += 220;
        }
      }, 3000);
    }
  });
</script>

